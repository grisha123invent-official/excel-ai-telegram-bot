# Telegram Excel Bot

Этот проект — Telegram-бот для работы с Excel-файлами из Google Drive прямо в чате Telegram.

## Возможности
- Подключение к Google Drive и отображение Excel-файлов из папки
- Выбор файла и анализ данных (ответы на вопросы, генерация таблиц)
- Использование сторонних скриптов для обработки данных

### Что умеет бот
- Показывает список Excel-файлов из Google Drive
- Позволяет выбрать файл и:
  - **Задать вопрос** по данным файла (бот с помощью ИИ анализирует содержимое и отвечает на вопросы о данных, трендах, статистике, фильтрации, сравнении и т.д.)
  - **Составить таблицу** — бот по описанию пользователя формирует новую таблицу или сводный отчет (например, "Покажи продажи по месяцам", "Сделай сводную по регионам", "Отфильтруй только последние 3 года" и т.п.)
  - **Вести диалог**: можно задавать уточняющие вопросы по данным, бот помнит контекст и историю чата
  - **Генерировать структурированный отчет** на основе всей истории диалога
- Все результаты (ответы, таблицы, отчеты) можно получить прямо в Telegram, включая скачивание новых Excel-файлов

### Типы обработки
- Анализ и фильтрация данных по любым условиям (даты, значения, категории)
- Построение сводных таблиц, группировка, агрегация
- Автоматическое определение структуры файла, поддержка нескольких листов
- Генерация SQL-запросов и их выполнение по данным Excel
- Работа с большими файлами (оптимизация через SQLite)
- Использование ИИ (OpenAI GPT) для понимания и выполнения сложных пользовательских запросов на естественном языке

## Условия лицензии
Использование бота платное — 30$ за одну установку/экземпляр.

Для приобретения лицензии и получения поддержки обращайтесь:
- Email: grisha123invent@griper.ru
- Telegram: @grisha123invent

## Установка и запуск
1. Клонируйте репозиторий
2. Установите зависимости из requirements.txt
3. Настройте переменные окружения (Google Service Account, токен Telegram)
4. Запустите `telegram-excel-bot.py`

## Как получить ключи и настроить переменные окружения

### Google Service Account (для доступа к Google Drive)
1. Перейдите в [Google Cloud Console](https://console.cloud.google.com/).
2. Создайте проект (если ещё нет).
3. В разделе "APIs & Services" включите Google Drive API.
4. В разделе "IAM & Admin" → "Service Accounts" создайте новый сервисный аккаунт.
5. Сгенерируйте ключ (JSON) и скачайте его.
6. Сохраните файл, например, как `service_account.json` (не добавляйте его в git!).
7. Добавьте email сервисного аккаунта в доступ к нужной папке Google Drive.

### OpenAI API Key (для работы с ИИ)
1. Зарегистрируйтесь на [OpenAI](https://platform.openai.com/).
2. Перейдите в раздел API Keys и создайте новый ключ.
3. Скопируйте ключ (начинается с `sk-...`).

### Переменные окружения (.env)
Создайте файл `.env` в корне проекта и добавьте туда:
```
SERVICE_ACCOUNT={содержимое JSON-файла сервисного аккаунта одной строкой}
OPENAI_API_KEY=sk-... (ваш ключ OpenAI)
TELEGRAM_TOKEN=... (токен вашего Telegram-бота)
```

**Важно:** Не публикуйте и не коммитьте файл `.env` и JSON с ключами!

## Контакты
- Email: grisha123invent@griper.ru
- Telegram: @grisha123invent 